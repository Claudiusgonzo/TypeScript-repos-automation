{
  "action": "opened",
  "issue": {
    "url": "https://api.github.com/repos/microsoft/TypeScript/issues/35451",
    "repository_url": "https://api.github.com/repos/microsoft/TypeScript",
    "labels_url": "https://api.github.com/repos/microsoft/TypeScript/issues/35451/labels{/name}",
    "comments_url": "https://api.github.com/repos/microsoft/TypeScript/issues/35451/comments",
    "events_url": "https://api.github.com/repos/microsoft/TypeScript/issues/35451/events",
    "html_url": "https://github.com/microsoft/TypeScript/issues/35451",
    "id": 531531204,
    "node_id": "MDU6SXNzdWU1MzE1MzEyMDQ=",
    "number": 35451,
    "title": "Explicit `this: this` annotation necessary to catch unbound class method errors with `--no-implicit-this`",
    "user": {
      "login": "Retsam",
      "id": 2281166,
      "node_id": "MDQ6VXNlcjIyODExNjY=",
      "avatar_url": "https://avatars0.githubusercontent.com/u/2281166?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Retsam",
      "html_url": "https://github.com/Retsam",
      "followers_url": "https://api.github.com/users/Retsam/followers",
      "following_url": "https://api.github.com/users/Retsam/following{/other_user}",
      "gists_url": "https://api.github.com/users/Retsam/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Retsam/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Retsam/subscriptions",
      "organizations_url": "https://api.github.com/users/Retsam/orgs",
      "repos_url": "https://api.github.com/users/Retsam/repos",
      "events_url": "https://api.github.com/users/Retsam/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Retsam/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [

    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2019-12-02T20:51:16Z",
    "updated_at": "2019-12-02T20:51:16Z",
    "closed_at": null,
    "author_association": "NONE",
    "body": "**TypeScript Version:**  3.7.2\r\n\r\n<!-- Search terms you tried before logging this (so others can find this issue more easily) -->\r\n**Search Terms:** `this` binding, `--no-implicit-this`, methods, `this: this`\r\n\r\n**Expected behavior:** The unbound `this` error is raised in both cases.\r\n\r\n**Actual behavior:** The compiler only catches the error in the case where the method was annotated as `this: this`.\r\n\r\n<!-- Did you find other bugs that looked similar? -->\r\n**Related Issues:**  Found *many* `this` issues, couldn't find any related to the default inferred value in the absence of a `this` annotation on class methods.  Sorry if I've just missed it.\r\n\r\n**Code**\r\n```ts\r\nclass Example1 {\r\n    value = \"value\";\r\n    method() {\r\n        return this.value.toUpperCase();\r\n    }\r\n}\r\n// Runtime-error, no compiler error\r\nnew Example1().method.call(null);\r\n\r\nclass Example2 {\r\n    value = \"value\";\r\n    method(this: this) {\r\n        return this.value.toUpperCase();\r\n    }\r\n}\r\n// Compiler error, as expected\r\nnew Example2().method.call(null);\r\n```\r\n\r\n\r\n\r\n<details><summary><b>Output<b></summary>\r\n\r\n```ts\r\n\"use strict\";\r\nclass Example1 {\r\n    constructor() {\r\n        this.value = \"value\";\r\n    }\r\n    method() {\r\n        return this.value.toUpperCase();\r\n    }\r\n}\r\n// Runtime-error, no compiler error\r\nnew Example1().method.call(null);\r\nclass Example2 {\r\n    constructor() {\r\n        this.value = \"value\";\r\n    }\r\n    method() {\r\n        return this.value.toUpperCase();\r\n    }\r\n}\r\n// Compiler error, as expected\r\nnew Example2().method.call(null);\r\n\r\n```\r\n\r\n\r\n</details>\r\n\r\n\r\n<details><summary><b>Compiler Options<b></summary>\r\n\r\n```json\r\n{\r\n  \"compilerOptions\": {\r\n    \"noImplicitAny\": true,\r\n    \"strictNullChecks\": true,\r\n    \"strictFunctionTypes\": true,\r\n    \"strictPropertyInitialization\": true,\r\n    \"strictBindCallApply\": true,\r\n    \"noImplicitThis\": true,\r\n    \"noImplicitReturns\": true,\r\n    \"useDefineForClassFields\": false,\r\n    \"alwaysStrict\": true,\r\n    \"allowUnreachableCode\": false,\r\n    \"allowUnusedLabels\": false,\r\n    \"downlevelIteration\": false,\r\n    \"noEmitHelpers\": false,\r\n    \"noLib\": false,\r\n    \"noStrictGenericChecks\": false,\r\n    \"noUnusedLocals\": false,\r\n    \"noUnusedParameters\": false,\r\n    \"esModuleInterop\": true,\r\n    \"preserveConstEnums\": false,\r\n    \"removeComments\": false,\r\n    \"skipLibCheck\": false,\r\n    \"checkJs\": false,\r\n    \"allowJs\": false,\r\n    \"declaration\": true,\r\n    \"experimentalDecorators\": false,\r\n    \"emitDecoratorMetadata\": false,\r\n    \"target\": \"ES2017\",\r\n    \"module\": \"ESNext\"\r\n  }\r\n}\r\n```\r\n\r\n\r\n</details>\r\n\r\n**Playground Link:** [Provided](https://www.typescriptlang.org/play/?ssl=4&ssc=1&pln=5&pc=1#code/MYGwhgzhAECiAeYC2AHEBTAjNA3gKGkOgDcwQBXdaAXmgCJSL06BuAopdAFwAsB7ACYAKAJS52RIgCdu5KQDtovAJYQAdI0pqufAKooU6KQGFI6UW0kBfPDYD0d6ACVy8rss4BaI1L5SANNDyfNDAfKjKGFLQPn548ugA7nCIqBiYomqcvIJqwGQgQvLkICAibHigkDAIyGjoAEzikppUtAxklKwS0Nn8wioQAFxKPKpi+JKSMlxyioManejaegZGphDm5T029o7G4SiRRjFSvgHQkDHwhsBc6ALxSSl1GA2Zfbn5pUUlZSxAA)\r\n      \r\n--- \r\n\r\nGiven this behavior, [I've submitted a PR to typescript-eslint](https://github.com/typescript-eslint/typescript-eslint/pull/1279) adding a linter rule that requires these annotations on all (non-arrow function) class methods that use `this`.\r\n\r\nHowever, I was wondering if there was a way this could be resolved on the Typescript compiler's side.  The two code examples above seem semantically identical to me, and it's strange that they type-check differently.  Is there a reason why it'd be harmful for `this: this` to be inferred from class methods that lack an explicit type annotation? \r\n\r\nNaturally, it would have to be behind a flag, but this is one of the few areas where I've hit runtime errors that the TS compiler hasn't caught.  It's led to our codebase being somewhat paranoid about attaching methods to the prototype, preferring to define almost all methods as arrow function instance properties, which is a bit unfortunate from a memory perspective."
  },
  "repository": {
    "id": 20929025,
    "node_id": "MDEwOlJlcG9zaXRvcnkyMDkyOTAyNQ==",
    "name": "TypeScript",
    "full_name": "microsoft/TypeScript",
    "private": false,
    "owner": {
      "login": "microsoft",
      "id": 6154722,
      "node_id": "MDEyOk9yZ2FuaXphdGlvbjYxNTQ3MjI=",
      "avatar_url": "https://avatars2.githubusercontent.com/u/6154722?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/microsoft",
      "html_url": "https://github.com/microsoft",
      "followers_url": "https://api.github.com/users/microsoft/followers",
      "following_url": "https://api.github.com/users/microsoft/following{/other_user}",
      "gists_url": "https://api.github.com/users/microsoft/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/microsoft/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/microsoft/subscriptions",
      "organizations_url": "https://api.github.com/users/microsoft/orgs",
      "repos_url": "https://api.github.com/users/microsoft/repos",
      "events_url": "https://api.github.com/users/microsoft/events{/privacy}",
      "received_events_url": "https://api.github.com/users/microsoft/received_events",
      "type": "Organization",
      "site_admin": false
    },
    "html_url": "https://github.com/microsoft/TypeScript",
    "description": "TypeScript is a superset of JavaScript that compiles to clean JavaScript output.",
    "fork": false,
    "url": "https://api.github.com/repos/microsoft/TypeScript",
    "forks_url": "https://api.github.com/repos/microsoft/TypeScript/forks",
    "keys_url": "https://api.github.com/repos/microsoft/TypeScript/keys{/key_id}",
    "collaborators_url": "https://api.github.com/repos/microsoft/TypeScript/collaborators{/collaborator}",
    "teams_url": "https://api.github.com/repos/microsoft/TypeScript/teams",
    "hooks_url": "https://api.github.com/repos/microsoft/TypeScript/hooks",
    "issue_events_url": "https://api.github.com/repos/microsoft/TypeScript/issues/events{/number}",
    "events_url": "https://api.github.com/repos/microsoft/TypeScript/events",
    "assignees_url": "https://api.github.com/repos/microsoft/TypeScript/assignees{/user}",
    "branches_url": "https://api.github.com/repos/microsoft/TypeScript/branches{/branch}",
    "tags_url": "https://api.github.com/repos/microsoft/TypeScript/tags",
    "blobs_url": "https://api.github.com/repos/microsoft/TypeScript/git/blobs{/sha}",
    "git_tags_url": "https://api.github.com/repos/microsoft/TypeScript/git/tags{/sha}",
    "git_refs_url": "https://api.github.com/repos/microsoft/TypeScript/git/refs{/sha}",
    "trees_url": "https://api.github.com/repos/microsoft/TypeScript/git/trees{/sha}",
    "statuses_url": "https://api.github.com/repos/microsoft/TypeScript/statuses/{sha}",
    "languages_url": "https://api.github.com/repos/microsoft/TypeScript/languages",
    "stargazers_url": "https://api.github.com/repos/microsoft/TypeScript/stargazers",
    "contributors_url": "https://api.github.com/repos/microsoft/TypeScript/contributors",
    "subscribers_url": "https://api.github.com/repos/microsoft/TypeScript/subscribers",
    "subscription_url": "https://api.github.com/repos/microsoft/TypeScript/subscription",
    "commits_url": "https://api.github.com/repos/microsoft/TypeScript/commits{/sha}",
    "git_commits_url": "https://api.github.com/repos/microsoft/TypeScript/git/commits{/sha}",
    "comments_url": "https://api.github.com/repos/microsoft/TypeScript/comments{/number}",
    "issue_comment_url": "https://api.github.com/repos/microsoft/TypeScript/issues/comments{/number}",
    "contents_url": "https://api.github.com/repos/microsoft/TypeScript/contents/{+path}",
    "compare_url": "https://api.github.com/repos/microsoft/TypeScript/compare/{base}...{head}",
    "merges_url": "https://api.github.com/repos/microsoft/TypeScript/merges",
    "archive_url": "https://api.github.com/repos/microsoft/TypeScript/{archive_format}{/ref}",
    "downloads_url": "https://api.github.com/repos/microsoft/TypeScript/downloads",
    "issues_url": "https://api.github.com/repos/microsoft/TypeScript/issues{/number}",
    "pulls_url": "https://api.github.com/repos/microsoft/TypeScript/pulls{/number}",
    "milestones_url": "https://api.github.com/repos/microsoft/TypeScript/milestones{/number}",
    "notifications_url": "https://api.github.com/repos/microsoft/TypeScript/notifications{?since,all,participating}",
    "labels_url": "https://api.github.com/repos/microsoft/TypeScript/labels{/name}",
    "releases_url": "https://api.github.com/repos/microsoft/TypeScript/releases{/id}",
    "deployments_url": "https://api.github.com/repos/microsoft/TypeScript/deployments",
    "created_at": "2014-06-17T15:28:39Z",
    "updated_at": "2019-12-02T20:35:43Z",
    "pushed_at": "2019-12-02T20:46:21Z",
    "git_url": "git://github.com/microsoft/TypeScript.git",
    "ssh_url": "git@github.com:microsoft/TypeScript.git",
    "clone_url": "https://github.com/microsoft/TypeScript.git",
    "svn_url": "https://github.com/microsoft/TypeScript",
    "homepage": "https://www.typescriptlang.org",
    "size": 1194161,
    "stargazers_count": 56143,
    "watchers_count": 56143,
    "language": "TypeScript",
    "has_issues": true,
    "has_projects": true,
    "has_downloads": true,
    "has_wiki": true,
    "has_pages": false,
    "forks_count": 7644,
    "mirror_url": null,
    "archived": false,
    "disabled": false,
    "open_issues_count": 4099,
    "license": {
      "key": "apache-2.0",
      "name": "Apache License 2.0",
      "spdx_id": "Apache-2.0",
      "url": "https://api.github.com/licenses/apache-2.0",
      "node_id": "MDc6TGljZW5zZTI="
    },
    "forks": 7644,
    "open_issues": 4099,
    "watchers": 56143,
    "default_branch": "master"
  },
  "organization": {
    "login": "microsoft",
    "id": 6154722,
    "node_id": "MDEyOk9yZ2FuaXphdGlvbjYxNTQ3MjI=",
    "url": "https://api.github.com/orgs/microsoft",
    "repos_url": "https://api.github.com/orgs/microsoft/repos",
    "events_url": "https://api.github.com/orgs/microsoft/events",
    "hooks_url": "https://api.github.com/orgs/microsoft/hooks",
    "issues_url": "https://api.github.com/orgs/microsoft/issues",
    "members_url": "https://api.github.com/orgs/microsoft/members{/member}",
    "public_members_url": "https://api.github.com/orgs/microsoft/public_members{/member}",
    "avatar_url": "https://avatars2.githubusercontent.com/u/6154722?v=4",
    "description": "Open source, from Microsoft with love"
  },
  "sender": {
    "login": "Retsam",
    "id": 2281166,
    "node_id": "MDQ6VXNlcjIyODExNjY=",
    "avatar_url": "https://avatars0.githubusercontent.com/u/2281166?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Retsam",
    "html_url": "https://github.com/Retsam",
    "followers_url": "https://api.github.com/users/Retsam/followers",
    "following_url": "https://api.github.com/users/Retsam/following{/other_user}",
    "gists_url": "https://api.github.com/users/Retsam/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Retsam/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Retsam/subscriptions",
    "organizations_url": "https://api.github.com/users/Retsam/orgs",
    "repos_url": "https://api.github.com/users/Retsam/repos",
    "events_url": "https://api.github.com/users/Retsam/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Retsam/received_events",
    "type": "User",
    "site_admin": false
  }
}
